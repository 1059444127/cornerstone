var cornerstoneTools=function(a,b,c){function d(c){var d=c.currentTarget,e=i[d];if(c.which==e.whichMouseButton){var f=b.pageToImage(d,c.pageX,c.pageY);e.startX=f.x,e.startY=f.y,e.endX=f.x,e.endY=f.y,e.lengthVisible=!0,a(document).mousemove(function(a){var c=b.pageToImage(d,a.pageX,a.pageY);e.endX=c.x,e.endY=c.y,b.updateImage(d)}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")})}}function e(a,b){if(0==g)return{count:g,mean:0,variance:0,stdDev:0};for(var c=Math.round(2*b),d=b*b,e=0,f=0,g=0,h=0,i=0;c>i;i++)for(var j=(b-i)*(b-i),k=0;c>k;k++){var l=(b-k)*(b-k),m=l+j;d>m&&(e+=a[h],f+=a[h]*a[h],g++),h++}var n=e/g,o=f/g-n*n;return{count:g,mean:n,variance:o,stdDev:Math.sqrt(o)}}function f(a){var c=i[a.detail.element];if(0!=c.lengthVisible){var d=Math.abs(c.startX-c.endX),f=Math.abs(c.startY-c.endY),g=Math.max(d,f)/2,h=(c.startX+c.endX)/2,j=(c.startY+c.endY)/2,k=a.detail.canvasContext;k.beginPath(),k.strokeStyle="white",k.lineWidth=1,k.beginPath(),k.arc(h,j,g,0,2*Math.PI),k.stroke(),k.fillStyle="white",k.font="6px Arial";var l=b.getStoredPixels(a.detail.element,h-g,j-g,2*g,2*g),m=e(l,g),n="Mean: "+m.mean.toFixed(2)+" StdDev: "+m.stdDev.toFixed(2);k.fillText(n,h,j)}}function g(b,c){b.addEventListener("CornerstoneImageRendered",f,!1);var e={whichMouseButton:c,lengthVisible:!1,startX:0,startY:0,endX:0,endY:0};i[b]=e,a(b).mousedown(d)}function h(b){b.removeEventListener("CornerstoneImageRendered",f),a(b).unbind("mousedown",d),i[b]=void 0}void 0===c&&(c={});var i={};return c.enableCircleRoi=g,c.disableCircleRoi=h,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c){var d=c.currentTarget,e=h[d];if(c.which==e.whichMouseButton){var f=b.pageToImage(d,c.pageX,c.pageY);e.startX=f.x,e.startY=f.y,e.endX=f.x,e.endY=f.y,e.lengthVisible=!0,a(document).mousemove(function(a){var c=b.pageToImage(d,a.pageX,a.pageY);e.endX=c.x,e.endY=c.y,b.updateImage(d)}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")})}}function e(a){var b=h[a.detail.element];if(0!=b.lengthVisible){var c=a.detail.canvasContext;c.beginPath(),c.strokeStyle="white",c.lineWidth=1,c.moveTo(b.startX,b.startY),c.lineTo(b.endX,b.endY),c.stroke(),c.fillStyle="white",c.font="6px Arial";var d=b.startX-b.endX*a.detail.image.columnPixelSpacing,e=b.startY-b.endY*a.detail.image.rowPixelSpacing,f=Math.sqrt(d*d+e*e),g=""+f.toFixed(2)+" mm";c.fillText(g,(b.startX+b.endX)/2,(b.startY+b.endY)/2)}}function f(b,c){b.addEventListener("CornerstoneImageRendered",e,!1);var f={whichMouseButton:c,lengthVisible:!1,startX:0,startY:0,endX:0,endY:0};h[b]=f,a(b).mousedown(d)}function g(b){b.removeEventListener("CornerstoneImageRendered",e),a(b).unbind("mousedown",d),h[b]=void 0}void 0===c&&(c={});var h={};return c.enableLength=f,c.disableLength=g,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c,d){a(c).mousedown(function(e){var f=e.pageX,g=e.pageY,h=e.which;h==d&&(a(document).mousemove(function(a){var d=a.pageX-f,e=a.pageY-g;f=a.pageX,g=a.pageY;var h=b.getViewport(c);h.centerX+=d/h.scale,h.centerY+=e/h.scale,b.setViewport(c,h)}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")}))})}return void 0===c&&(c={}),c.pan=d,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c){var d=c.currentTarget,e=h[d];if(c.which==e.whichMouseButton){var f=b.pageToImage(d,c.pageX,c.pageY);e.x=f.x,e.y=f.y,e.visible=!0,a(document).mousemove(function(a){var c=b.pageToImage(d,a.pageX,a.pageY);e.x=c.x,e.y=c.y,b.updateImage(d)}),a(document).mouseup(function(){e.visible=!1,b.updateImage(d),a(document).unbind("mousemove"),a(document).unbind("mouseup")})}}function e(a){var c=h[a.detail.element];if(0!=c.visible){var d=a.detail.canvasContext;d.beginPath(),d.fillStyle="white",d.font="6px Arial";var e=b.getStoredPixels(a.detail.element,c.x,c.y,1,1),f=e[0],g=f*a.detail.image.slope+a.detail.image.intercept,i=""+Math.round(c.x)+","+Math.round(c.y)+" SP: "+f+" MO: "+g;d.fillText(i,c.x+3,c.y-3)}}function f(b,c){b.addEventListener("CornerstoneImageRendered",e,!1);var f={whichMouseButton:c,visible:!1,x:0,y:0};h[b]=f,a(b).mousedown(d)}function g(b){b.removeEventListener("CornerstoneImageRendered",e),a(b).unbind("mousedown",d),h[b]=void 0}void 0===c&&(c={});var h={};return c.enableProbe=f,c.disableProbe=g,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c,d,e){var f=0;0==e?a(c).on("mousewheel DOMMouseScroll",function(a){return a.originalEvent.wheelDelta<0||a.originalEvent.detail>0?f<d.length-1&&(f++,b.showImage(c,d[f])):f>0&&(f--,b.showImage(c,d[f])),!1}):a(c).mousedown(function(g){var h=g.pageX,i=g.pageY,j=g.which;j==e&&(a(document).mousemove(function(a){var e=(a.pageX-h,a.pageY-i);h=a.pageX,i=a.pageY,0>e?f<d.length-1&&(f++,b.showImage(c,d[f])):e>0&&f>0&&(f--,b.showImage(c,d[f]))}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")}))})}return void 0===c&&(c={}),c.scroll=d,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c){var d=c.data.whichMouseButton,e=c.pageX,f=c.pageY,g=c.which;if(g==d){var h=c.currentTarget;a(document).mousemove(function(a){var c=a.pageX-e,d=a.pageY-f;e=a.pageX,f=a.pageY;var g=b.getViewport(h);g.windowWidth+=c/g.scale,g.windowCenter+=d/g.scale,b.setViewport(h,g)}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")})}}function e(b,c){var e={whichMouseButton:c};a(b).mousedown(e,d)}function f(b){a(b).unbind("mousedown",d)}return void 0===c&&(c={}),c.windowWidthWindowCenter=e,c.disableWindowWidthWindowCenter=f,c}($,cornerstone,cornerstoneTools),cornerstoneTools=function(a,b,c){function d(c,d){0==d?a(c).on("mousewheel DOMMouseScroll",function(a){if(a.originalEvent.wheelDelta<0||a.originalEvent.detail>0){var d=b.getViewport(c);d.scale-=.25,b.setViewport(c,d)}else{var d=b.getViewport(c);d.scale+=.25,b.setViewport(c,d)}return!1}):a(c).mousedown(function(e){var f=e.pageX,g=e.pageY,h=e.which;h==d&&(a(document).mousemove(function(a){var d=(a.pageX-f,a.pageY-g);f=a.pageX,g=a.pageY;var e=b.getViewport(c);e.scale+=d/100,b.setViewport(c,e)}),a(document).mouseup(function(){a(document).unbind("mousemove"),a(document).unbind("mouseup")}))})}return void 0===c&&(c={}),c.zoom=d,c}($,cornerstone,cornerstoneTools);